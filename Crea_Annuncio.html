<html>
    <head>
        <title>Crea Annuncio</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css">
        <script src="Javascript/Utente.js" type="text/javascript"></script>
        <link href="Css/Css_Aggiuntivo.css" rel="stylesheet" type="text/css"/>
         <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
          <script> $(function(){  $("#footer").load("Footer.html"); }); </script>
    </head>
    <body>
        
        <script>
            
  function getCookie(name)
 {
   var re = new RegExp(name + "=([^;]+)");
   var value = re.exec(document.cookie);
   return (value != null) ? unescape(value[1]) : null;
 };
 
 
            
            $(document).ready(function(){
                document.getElementById("price").style.display = 'none';
                var jform = new FormData();
                document.getElementById("alert").style.display = 'none';
                document.getElementById("success").style.display = 'none';
              
            $("#submit").click(function(){
                
                jform.append("title", $("#name").val());
                jform.append("desc", $("#description").val());
                jform.append("category", $("#categ").val());
                jform.append("price", $("#price").val());
               jform.append("image1", $('input[type=file]')[0].files[0]);
                jform.append("image2", $('input[type=file]')[1].files[0]);
                 jform.append("image3", $('input[type=file]')[2].files[0]);
                jform.append("token", getCookie('token'));
         
     
     $.ajax({
            type: "POST",
            enctype: 'multipart/form-data',
            url: "https://messageinabot.herokuapp.com/ads",
            data: jform,
           
            processData: false,
            contentType: false,
            cache: false,
            timeout: 600000,
            success: function (data){
                console.log(data);
             if(data.success){
          document.getElementById("alert").style.display = 'none';
          document.getElementById("success").style.display = 'block';
          document.getElementById("success").innerHTML = "Congratulazioni, annuncio creato con successo!";
         /*window.setTimeout(function(){
           location.href = "Annuncio.html?id="+ data.id;
          }, 8000);*/
          
        }else{
            
          document.getElementById("alert").style.display = 'block';
          document.getElementById("alert").innerHTML = "Errore, controlla di aver scritto tutto correttamente!";
      }
      
  }
     });
       
            
        });
    $("#checkbox_price").click(function(){
 
  if(document.getElementById("checkbox_price").value == 'Aggiungi prezzo' ){
         document.getElementById("price").style.display = 'block';
         document.getElementById("checkbox_price").value = 'Togli prezzo';
     }else{
         document.getElementById("price").style.display = 'none';
    document.getElementById("checkbox_price").value =  'Aggiungi prezzo';
         }
 });
        });
    
    
        </script>
       <div class="bg-gray">
           <center><a href="index.html">
                   <img class="margine_articoli_piccoli" src="https://i.imgur.com/XjoERkn.png"  alt=""/>
  </a></center>
            <div class="container bg-dark rounded border border-secondary margine_form">
                
                <div class="row align-self-center">
                    
                    <div class="col-md-10 offset-md-1 form_spaziatura">
                        
                <form name="modulo" method="POST"  enctype="multipart/form-data" >
                     <div class="form-group">
                         <label class=" font_sito_scritte scritta_utente_form">Nome Annuncio</label>
                         <input type="text" class="form-control" placeholder="Nome" id="name" name="name"> 
                    </div>
                    <div class="form-group">
                        <label  class=" font_sito_scritte scritta_utente_form">Descrizione</label>
                        <textarea class="form-control" placeholder="Scrivi una breve descrizione sull'annuncio (Max 360 caratteri)" id="description" rows="3"></textarea>
                        
                    </div>
                    <div class="form-group">
                        <label class=" font_sito_scritte scritta_utente_form">Categoria</label>
                       <select class="form-control" id="categ" name="categ">
                                    <!-- INSERIRE DROPDOWN -->
                                    <option selected value='libri'>Libri</option>
                                    <option value='appunti'>Appunti</option>
                                    <option value='stage/Lavoro'>Stage/Lavoro</option>   
                                    <option value='ripetizione'>Ripetizione</option>                                    
                                    <option value='eventi'>Eventi</option>
                                </select>
                    </div>
                    
                    
                   <div class="form-group">
                       <label class=" font_sito_scritte scritta_utente_form">Prezzo (Opzionale)</label><br>
                       <input type="button" class="btn btn-success" id="checkbox_price" value="Aggiungi prezzo"><br><br>
                        <input type="text"  class="form-control" id="price" value="0.00">
                    </div>
                    <div class="form-group">
                        <label class=" font_sito_scritte scritta_utente_form">Immagini (Opzionale/Massimo 3 immagini)</label> <br>
                        <input type="file" id="image1" name="image">
                    </div>
                     <div class="form-group">
                        
                        <input type="file" id="image2" name="image">
                    </div>
                    <div class="form-group">
                        
                        <input type="file" id="image3" name="image">
                    </div>
                    <center><div id="alert" class="alert alert-danger" role="alert"></div>
                        <div id="success" class="alert alert-success" role="alert"></div>
                        
                        <input id="submit" onclick="" type="button" class="btn btn-success font_sito_bottoni cartellone" value="Crea Annuncio"></center>
                     
                </form>
                    </div>  
            </div>  
            </div>
        </div>
        <br>
        <br>
        <div id="footer"></div>
    </body>
</html>


         

        
     
    
