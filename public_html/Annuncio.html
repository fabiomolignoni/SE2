<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<!doctype html>
<html>
  <head>
    <title>Annuncio</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.0.0.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" crossorigin="anonymous"></script>
    <link href="Css/Css_Aggiuntivo.css" rel="stylesheet" type="text/css"/>
    <script src="Javascript/Utente.js" type="text/javascript"></script>
   
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" ></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js"></script>
  
 
      <script> $(function(){ $("#header_not_registered").load("Header_Not_Reg.html"); $("#header_registered").load("Header_Reg.html"); $("#footer").load("Footer.html"); }); </script>
  </head>
  <body>
      <script>
            function getCookie(name)
 {
   var re = new RegExp(name + "=([^;]+)");
   var value = re.exec(document.cookie);
   return (value != null) ? unescape(value[1]) : null;
 };
 
 
  
  function doLogout(){
    deleteCookie('token');
  };

function findGetParameter(parameterName) {
    var result = null,
        tmp = [];
    var items = location.search.substr(1).split("&");
    for (var index = 0; index < items.length; index++) {
        tmp = items[index].split("=");
        if (tmp[0] === parameterName) result = decodeURIComponent(tmp[1]);
    }
    return result;
}

  //Carica gli header a seconda della situazione
var myResponseHandler = function() {
  if (this.readyState == 3 && this.status == 403) {
    document.getElementById("header_not_registered").style.display = 'block';
  }
};


function findUserName(param){
     $.ajax({
            type: "GET",
            enctype: 'multipart/form-data',
            url: param,
            
           
            processData: false,
            contentType: false,
            cache: false,
            timeout: 600000,
            success: function (data){
                
             document.getElementById("user_name").innerHTML = data.name;
             document.getElementById("user_surname").innerHTML = data.surname;
    document.getElementById("utente_img").src= data.image;
    if(data.phone != null){
    document.getElementById("phone").innerHTML = data.phone;
    }
   document.getElementById("email_user").innerHTML = data.email;
      
  }
     });
    
}
        $(document).ready(function(){
            var id = findGetParameter("id");
            
    document.getElementById("header_not_registered").style.display = 'none';
    document.getElementById("header_registered").style.display = 'none';
var req = new XMLHttpRequest();
  req.open('GET', "https://messageinabot.herokuapp.com/users?token="+getCookie('token'));
  req.onreadystatechange = myResponseHandler;

  req.send();

    $.get("https://messageinabot.herokuapp.com/users?token="+getCookie('token'),{},function(data){
      if(data.success){
        
        document.getElementById("header_registered").style.display = 'block';
        document.getElementById("nome").innerHTML = "Benvenuto" + " " + data.name;
          document.getElementById("img_profilo").src = data.image;
      }
    });
   
   $.get("https://messageinabot.herokuapp.com/ads/"+id,{},function(data){
       
      for(i = 0;i<3;i++){
          if(data.ad.images[i] == null){
          document.getElementById("lato"+i).style.visibility = "hidden";
          }
          else{
        document.getElementById("lato"+i).src = data.ad.images[i];
        document.getElementById("img_"+i).src = data.ad.images[i];
     }
     
     }
     
   
      document.getElementById("titolo").innerHTML = data.ad.title;
      document.getElementById("descrizione").innerHTML = data.ad.desc;
      
      if(data.ad.price == 0.00){
          document.getElementById("prezzo").innerHTML = "Gratis";
      }
      else
      {
           document.getElementById("prezzo").innerHTML = data.ad.price + "â‚¬";
      }
      var user = data.user;
     findUserName(user);
    });
    $('#lato0').click(function(){
       
       $('.carousel').carousel(0);
    
    });
    
    $('#lato1').click(function(){
       
       $('.carousel').carousel(1);
    
    });
    
    $('#lato2').click(function(){
       
       $('.carousel').carousel(2);
    
    });
    
    
    // Get the modal
var modal = document.getElementById('myModal');

// Get the button that opens the modal
var btn = document.getElementById("contatta");

// Get the <span> element that closes the modal
var span = document.getElementsByClassName("close")[0];

// When the user clicks on the button, open the modal 
btn.onclick = function() {
    modal.style.display = "block";
}

// When the user clicks on <span> (x), close the modal
span.onclick = function() {
    modal.style.display = "none";
}

// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
    if (event.target == modal) {
        modal.style.display = "none";
    }
}
    
    
    
    });
   
  
        </script>

  
    <div id="header_not_registered"></div>
        <div id="header_registered"></div>
    <div id="bg-gray">
        <div class="container-fluid">
            <div class="container">
           
            
                  <div class="row">
                      <div class="col-md-4">
                          <figure class="figure"><input  src="https://via.placeholder.com/200x100" type="image" class="anteprima_img margine_articoli_piccoli figure-img img-fluid rounded" id="lato0">
                             </figure>
                          <br>
                          <figure class="figure">
                              <input type="image" src="https://via.placeholder.com/200x100" class="anteprima_img margine_articoli_piccoli figure-img img-fluid rounded" id="lato1">
                              
 
</figure>
                          
                          <br>
                          <figure class="figure">
                              <input src="https://via.placeholder.com/200x100" type="image" class="anteprima_img margine_articoli_piccoli figure-img img-fluid rounded" id="lato2">
                              
</figure>
                      </div>
                      <div class="col-md-5">
                    <div id="carouselExampleControls" class="carousel slide scatola_immagine margine_articoli_piccoli" data-ride="carousel">
  <div class="carousel-inner">
    <div class="carousel-item active">
        <img class="d-block w-100" src="data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%22400%22%20height%3D%22300%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20400%20300%22%20preserveAspectRatio%3D%22none%22%3E%3Cdefs%3E%3Cstyle%20type%3D%22text%2Fcss%22%3E%23holder_160179e26ec%20text%20%7B%20fill%3Argba(255%2C255%2C255%2C.75)%3Bfont-weight%3Anormal%3Bfont-family%3AHelvetica%2C%20monospace%3Bfont-size%3A20pt%20%7D%20%3C%2Fstyle%3E%3C%2Fdefs%3E%3Cg%20id%3D%22holder_160179e26ec%22%3E%3Crect%20width%3D%22400%22%20height%3D%22300%22%20fill%3D%22%23777%22%3E%3C%2Frect%3E%3Cg%3E%3Ctext%20x%3D%22148.859375%22%20y%3D%22159%22%3E400x300%3C%2Ftext%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E" id="img_0"  alt="First slide">
    </div>
    <div class="carousel-item">
      <img class="d-block w-100" src="data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%22400%22%20height%3D%22300%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20400%20300%22%20preserveAspectRatio%3D%22none%22%3E%3Cdefs%3E%3Cstyle%20type%3D%22text%2Fcss%22%3E%23holder_160179e26ec%20text%20%7B%20fill%3Argba(255%2C255%2C255%2C.75)%3Bfont-weight%3Anormal%3Bfont-family%3AHelvetica%2C%20monospace%3Bfont-size%3A20pt%20%7D%20%3C%2Fstyle%3E%3C%2Fdefs%3E%3Cg%20id%3D%22holder_160179e26ec%22%3E%3Crect%20width%3D%22400%22%20height%3D%22300%22%20fill%3D%22%23777%22%3E%3C%2Frect%3E%3Cg%3E%3Ctext%20x%3D%22148.859375%22%20y%3D%22159%22%3E400x300%3C%2Ftext%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E" id="img_1"  alt="Second slide">
    </div>
    <div class="carousel-item">
      <img class="d-block w-100" src="data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%22400%22%20height%3D%22300%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20400%20300%22%20preserveAspectRatio%3D%22none%22%3E%3Cdefs%3E%3Cstyle%20type%3D%22text%2Fcss%22%3E%23holder_160179e26ec%20text%20%7B%20fill%3Argba(255%2C255%2C255%2C.75)%3Bfont-weight%3Anormal%3Bfont-family%3AHelvetica%2C%20monospace%3Bfont-size%3A20pt%20%7D%20%3C%2Fstyle%3E%3C%2Fdefs%3E%3Cg%20id%3D%22holder_160179e26ec%22%3E%3Crect%20width%3D%22400%22%20height%3D%22300%22%20fill%3D%22%23777%22%3E%3C%2Frect%3E%3Cg%3E%3Ctext%20x%3D%22148.859375%22%20y%3D%22159%22%3E400x300%3C%2Ftext%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E" id="img_2" alt="Third slide">
    </div>
  </div>
                        <a class="carousel-control-prev " href="#carouselExampleControls" role="button" data-slide="prev">
                            <img class="dimensioni_frecce" src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/26/Chevron_left_font_awesome.svg/120px-Chevron_left_font_awesome.svg.png">
    
    <span class="sr-only">Previous</span>
  </a>
  <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
    <img class="dimensioni_frecce" src="https://i.imgur.com/gSR1pAj.png">
    <span class="sr-only ">Next</span>
  </a>
</div>
                      </div>
                      <div class="offset-md-3">
                  </div>
                  </div>
                  <hr>      
                  <div class="row">
                                <div class="col-lg-2 col-md-2 col-sm-2">
                                     <center>
                                        
                                         <img class="img_pad img_rotonda" id="utente_img" alt=""/>
                                        <br>
                                        <br>
                                        <p><h2 id="user_name" class="font_sito_scritte_nere"></h2  >
                                            <h2 id="user_surname" class="font_sito_scritte_nere">
                                        </h2  ></center>
                                       
                                        
                                
                                </div>
                                <div class="col-lg-8 col-md-8 col-sm-8"> 
                                    <h1 id="titolo" class="font_sito_scritte_nere">Titolo </h1>
                                    <br>
                                    <div class="jumbotron">
                                        <p id="descrizione" class=" font_sito_scritte_nere_articolo font_sito_scritte_nere_grandezza"></p>
                                    </div>
                                    
                                 </div>
                      <div class="col-lg-2 col-md-2 col-sm-2">
                          <center><h1 class="font_sito_scritte_nere">Prezzo</h1><br>
                           
                              <p class="testo_pad font_sito_scritte_nere_articolo scritta_utente_form" id="prezzo"></p></center>
                              
                              
                          <hr>
                          
                          <br>  
                         
                          <center> <input type="button" class="btn btn-success" id="contatta" value="Contatta"></center></div>
          
<!-- The Modal -->
<div id="myModal" class="modal">

  <!-- Modal content -->
<div class="modal-content">
  <div class="modal-header">
    <span class="close">&times;</span>
    <h2>Contatti</h2>
  </div>
  <div class="modal-body">
      <h4>Telefono</h4>
      <p id="phone"></p>
    <h4>Email</h4>
      <p id="email_user"></p>
  </div>
  
</div>

</div>
        
                
        </div>
            
            
            
            
            
            </div>
   </div>
    </div>
    <div id="footer"></div>
  </body>
</html>